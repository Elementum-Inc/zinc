{% style %}
.header {
  padding-top: {{ section.settings.padding_top }}px;
}
.top-link > a,
.header__menu-trigger,
.header__icon-link {
  padding-bottom: {{ section.settings.padding_bottom }}px;
}
{% endstyle %}
{%- if settings.cart_type == "drawer" -%}
  {{ 'component-cart-drawer.css' | asset_url | stylesheet_tag }}
  {{ 'component-cart.css' | asset_url | stylesheet_tag }}
  {{ 'component-totals.css' | asset_url | stylesheet_tag }}
  {{ 'component-price.css' | asset_url | stylesheet_tag }}
  {{ 'component-discounts.css' | asset_url | stylesheet_tag }}
  {{ 'component-loading-overlay.css' | asset_url | stylesheet_tag }}

  {{ 'et_price.css' | asset_url | stylesheet_tag }}
{%- endif -%}

<script src="{{ 'cart-notification.js' | asset_url }}" defer="defer"></script>
{%- if settings.cart_type == "drawer" -%}
  <script src="{{ 'cart-drawer.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

<header class="header {{ section.settings.color_scheme }} color-scheme--{{ section.settings.color_scheme }} logo-{{ section.settings.logo_position }}">
  {% comment %} logo {% endcomment %}
  <h1 class="header__logo order-none">
    <a href="{{ routes.root_url }}">
      {%- if section.settings.logo != blank -%}
        {%- assign logo_alt = section.settings.logo.alt | default: shop.name | escape -%}
        {%- assign logo_height = section.settings.logo_width | divided_by: section.settings.logo.aspect_ratio -%}
        {{ section.settings.logo | image_url: width: section.settings.width | image_tag:
          class: 'logo__image',
          widths: '50, 100, 150, 200, 250, 300, 400, 500',
          height: logo_height,
          width: section.settings.logo_width,
          alt: logo_alt
        }}
      {%- else -%}
        <span class="logo__fallback">{{ shop.name }}</span>
      {%- endif -%}
    </a>
  </h1>
  {% comment %} theme-check-disable LiquidTag {% endcomment %}
  {% capture topmenuJson %}
    {% render 'menu-json', menu: section.settings.menu %}
  {% endcapture %}
  {% capture mobileLinksJson %}
    {% render 'menu-json', menu: section.settings.mm_mobile_links %}
  {% endcapture %}
  {% comment %} theme-check-enable LiquidTag {% endcomment %}
  {% capture blocks %}
    [
      {% for block in section.blocks %}
        {
          "id": "{{ block.id }}",
          "settings": {% if block.type == 'menu' %}
            {
              "submenu": {% render 'menu-json', menu: block.settings.submenu %},
              "submenu_title": "{{ block.settings.submenu_title }}",
              "submenu_item_image": "{{ block.settings.submenu_item_image }}",
              "title": "{{ block.settings.title }}" 
            }
          {% else %}
            {
              "content": "{{ block.settings.content }}",
              "content_title": "{{ block.settings.content_title }}",
              "content_subtitle": "{{ block.settings.content_subtitle }}",
              "image": {
                "alt": "{{ block.settings.image.alt }}",
                "aspect_ratio": {{ block.settings.image.aspect_ratio }},
                "height": "{{ block.settings.image.height }}",
                "id": {{ block.settings.image.id }},
                "url": "{{ block.settings.image | image_url }}",
                "width": "{{ block.settings.image.width }}"
              },
              "primary_button_text": "{{ block.settings.primary_button_text }}",
              "primary_button_url": "{{ block.settings.primary_button_url }}",
              "secondary_button_text": "{{ block.settings.secondary_button_text }}",
              "secondary_button_url": "{{ block.settings.secondary_button_url }}",
              "title": "{{ block.settings.title }}"
            }
          {% endif %},
          "shopify_attributes": {{ block.shopify_attributes | json }},
          "type": "{{ block.type }}"
        }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ]
  {% endcapture %}
  {% comment %} menu {% endcomment %}
  {% if section.settings.menu %}
    <div id="megamenu"
      class="header__menu order-1"
      data-settings="{{ section.settings | json | escape }}"
      data-blocks="{{ blocks | strip_newlines | escape }}"
      data-topmenu="{{ topmenuJson | strip_newlines | escape }}"
      data-mobilelinks="{{ mobileLinksJson | strip_newlines | escape }}"
      data-app-type="mega-menu"
      data-app
    ></div>
  {% endif %}
  {% comment %} user menu {% endcomment %}
  <div class="header__user-menu order-2 {{ section.settings.user_menu_type }} icons-{{ section.settings.menu_icon_position }}">
    {% comment %} search {% endcomment %}
    <div id="searchMenuTop"
      data-settings="{{ section.settings | json | escape }}"
      data-app-type="search-menu"
      data-app
    ></div>

    {%- assign app_type = 'test' -%}

    <div class=""
      data-app-type="{{ app_type }}"
      data-app-id="{{ section.id }}">
      <script id="{{ section.id }}-{{ app_type }}">
        window.vue.availableApps.push({
          type: "{{ app_type }}",
          id: "{{ section.id }}",
          data: {
            "settings": {{ section.settings | json }}
          }
        })
      </script>
    </div>
    {% comment %} user {% endcomment %}
    <a class="header__icon-link account-link" href="{{ routes.account_url }}">
      <span class="icon target">
        {% render 'icon-user' %}
      </span>
     <span class="label">Account</span>
    </a>
    {% comment %} cart {% endcomment %}
    <a class="header__icon-link cart-link" href="{{ routes.cart_url }}" id="cart-icon-bubble">
      <span class="icon target">
        {% render 'icon-shopping-bag' %}

        {%- if cart != empty -%}
        <div class="cart-count-bubble">
          {%- if cart.item_count < 100 -%}
            <span aria-hidden="true">{{ cart.item_count }}</span>
          {%- endif -%}
          <span class="visually-hidden">{{ 'sections.header.cart_count' | t: count: cart.item_count }}</span>
        </div>
      {%- endif -%}
      
      </span>
     <span class="label">Cart

     
     </span>
     
    </a>
  </div>
</header>

{%- if settings.cart_type == "notification" -%}
  {%- render 'cart-notification', color_scheme: section.settings.color_scheme -%}
{%- endif -%}

{% schema %}
{
  "name": "t:sections.header.name",
  "class": "section-header",
  "settings": [
    {
      "type": "select",
      "id": "color_scheme",
      "options": [
        {
          "value": "primary",
          "label": "Primary"
        },
        {
          "value": "secondary",
          "label": "Secondary"
        },
        {
          "value": "accent-1",
          "label": "Accent 1"
        },
        {
          "value": "accent-2",
          "label": "Accent 2"
        }
      ],
      "default": "primary",
      "label": "t:sections.all.colors.label"
    },
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "t:sections.header.settings.logo.label",
      "info": "TODO: add note on proper sizing for logo"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 48,
      "max": 200,
      "step": 8,
      "default": 64,
      "unit": "t:sections.header.settings.logo_width.unit",
      "label": "t:sections.header.settings.logo_width.label"
    },
    {
      "type": "select",
      "id": "logo_position",
      "options": [
        {
          "value": "left",
          "label": "t:sections.header.settings.logo_position.options__1.label"
        },
        {
          "value": "right",
          "label": "t:sections.header.settings.logo_position.options__2.label"
        },
        {
          "value": "split-menu",
          "label": "t:sections.header.settings.logo_position.options__3.label"
        },
        {
          "value": "top-left",
          "label": "t:sections.header.settings.logo_position.options__4.label"
        },
        {
          "value": "top-right",
          "label": "t:sections.header.settings.logo_position.options__5.label"
        },
        {
          "value": "top-center",
          "label": "t:sections.header.settings.logo_position.options__6.label"
        }
      ],
      "default": "left",
      "label": "t:sections.header.settings.logo_position.label",
      "info": "t:sections.header.settings.logo_position.info"
    },
    {
      "type": "header",
      "content": "Menu"
    },
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "t:sections.header.settings.menu.label"
    },
    {
      "type": "checkbox",
      "id": "collapse_menu_desktop",
      "default": false,
      "label": "t:sections.header.settings.collapse_menu_desktop.label",
      "info": "t:sections.header.settings.collapse_menu_desktop.info"
    },
    {
      "type": "checkbox",
      "id": "enable_sticky_header",
      "default": true,
      "label": "t:sections.header.settings.enable_sticky_header.label",
      "info": "t:sections.header.settings.enable_sticky_header.info"
    },
    {
      "type": "header",
      "content": "Mega Menu"
    },
    {
      "type": "select",
      "id": "mm_color_scheme",
      "options": [
        {
          "value": "primary",
          "label": "Primary"
        },
        {
          "value": "secondary",
          "label": "Secondary"
        },
        {
          "value": "accent-1",
          "label": "Accent 1"
        },
        {
          "value": "accent-2",
          "label": "Accent 2"
        }
      ],
      "default": "primary",
      "label": "t:sections.all.colors.label"
    },
    {
      "type": "select",
      "id": "mm_type",
      "options": [
        {
          "value": "basic",
          "label": "Basic"
        },
        {
          "value": "bold",
          "label": "Bold"
        }
      ],
      "default": "basic",
      "label": "Menu Type",
      "info": "TODO: A note on the difference between basic and bold."
    },
    {
      "type": "link_list",
      "id": "mm_mobile_links",
      "label": "Mobile Bottom Links",
      "info": "Use this setting to provide some additional links in the mobile menu."
    },
    {
      "type": "header",
      "content": "User Menu"
    },
    {
      "type": "select",
      "id": "user_menu_type",
      "options": [
        {
          "value": "minimal",
          "label": "t:sections.header.settings.user_menu_type.options__1.label"
        },
        {
          "value": "compact",
          "label": "t:sections.header.settings.user_menu_type.options__2.label"
        },
        {
          "value": "expanded",
          "label": "t:sections.header.settings.user_menu_type.options__3.label"
        }
      ],
      "default": "minimal",
      "label": "t:sections.header.settings.user_menu_type.label",
      "info": "t:sections.header.settings.user_menu_type.info"
    },
    {
      "type": "select",
      "id": "menu_icon_position",
      "options": [
        {
          "value": "left",
          "label": "t:sections.header.settings.menu_icon_position.options__1.label"
        },
        {
          "value": "right",
          "label": "t:sections.header.settings.menu_icon_position.options__2.label"
        },
        {
          "value": "top",
          "label": "t:sections.header.settings.menu_icon_position.options__3.label"
        }
      ],
      "default": "left",
      "label": "t:sections.header.settings.menu_icon_position.label",
      "info": "t:sections.header.settings.menu_icon_position.info"
    },
    {
      "type": "header",
      "content": "Country/Language Selection"
    },
    {
      "type": "checkbox",
      "id": "enable_country_selector",
      "default": false,
      "label": "t:sections.footer.settings.enable_country_selector.label"
    },
    {
      "type": "checkbox",
      "id": "enable_language_selector",
      "default": false,
      "label": "t:sections.footer.settings.enable_language_selector.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 36,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 20
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 36,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 20
    }
  ],
  "max_blocks": 6,
  "blocks": [
    {
      "name": "Menu",
      "type": "menu",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Top menu parent",
          "info": "Your megamenu is built according to block order and this setting, which attaches the submenu to it's parent in the top menu. For more details on how to use this megamenu, please [eventually click here](https://google.com)."
        },
        {
          "type": "text",
          "id": "submenu_title",
          "label": "Submenu heading",
          "info": "If left blank, the navigation's default title will populate."
        },
        {
          "type": "link_list",
          "id": "submenu",
          "label": "Submenu"
        },
        {
          "type": "select",
          "id": "submenu_item_image",
          "label": "Thumbnail positions",
          "options": [
            {
              "value": "top",
              "label": "Top"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "none",
              "label": "None"
            }
          ],
          "default": "none"
        }
      ]
    },
    {
      "name": "Image/Content",
      "type": "image_content",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Top menu parent",
          "info": "Your megamenu is built according to block order and this setting, which attaches the submenu to it's parent in the top menu. For more details on how to use this megamenu, please [eventually click here](https://google.com)."
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "content_title",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "content_subtitle",
          "label": "Subheading"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Content"
        },
        {
          "type": "header",
          "content": "Buttons"
        },
        {
          "type": "text",
          "id": "primary_button_text",
          "label": "Primary Button text"
        },
        {
          "type": "url",
          "id": "primary_button_url",
          "label": "Primary Button link"
        },
        {
          "type": "text",
          "id": "secondary_button_text",
          "label": "Secondary Button text"
        },
        {
          "type": "url",
          "id": "secondary_button_url",
          "label": "Primary Button link"
        }
      ]
    }
  ]
}
{% endschema %}